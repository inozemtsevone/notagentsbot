import os
from flask import Flask, request, send_file
from telegram import Update, Bot
from telegram.ext import Dispatcher, CommandHandler, MessageHandler, Filters
from io import BytesIO
from docx import Document
from docx.shared import RGBColor

# Список имён иноагентов для зачеркивания (пример)
FOREIGN_AGENT_NAMES = ["Иван Иванов", "Мария Петрова", "John Smith", "Ресурсный центр для ЛГБТ", "Босов Катерина Евгеньевна", "Общество с ограниченной ответственностью «ЕЛКИН КАРТОН»",
    "Ресурсный центр для ЛГБТ",
    "Телеканал Дождь",
    "Anti-Corruption Foundation Inc.",
    "Deutsche Welle (Германия, Kurt-Schumacher-Strasse 3, 53113 Bonn)",
    "Hidemy.network Ltd.",
    "MRR-Fund gemeinnützige UG (haftungsbeschränkt), реализующий проект My Russian Rights",
    "The Bell",
    "BILD на русском",
    "Idel.Реалии",
    "Медиазона",
    "Алексей Навальный",
    "Алексей Венедиктов",
    "Максим Кац",
    "Илья Варламов",
    "Иноземцев Александр Александрович",
    "Быкова Анна Дмитриевна",
    "Михаил Ходорковский",
    "Григорий Чхартишвили (Борис Акунин)",
    "Юлия Латынина",
    "Александр Невзоров",
    "Евгений Чичваркин",
    "Виктор Шендерович",
    "Ольга Романова",
    "Марк Фейгин",
    "Русская служба BBC",
    "Голос Америки",
    "Радио Свобода",
    "Медиахолдинг «Медуза»",
    "Альянс врачей",
    "ОВД-Инфо",
    "Проект",
    "Настоящее Время",
    "Репаблик",
    "МБХ Медиа",
    "Агора",
    "Команда 29",
    "Правозащита Открытки",
    "Русь сидящая",
    "Апология протеста",
    "Фонд борьбы с коррупцией",
    "Фонд защиты прав граждан",
    "Алексей Горинов",
    "Иван Жданов",
    "Леонид Волков",
    "Александр Сотник",
    "Марат Гельман",
    "Ксения Ларина",
    "Гарри Каспаров",
    "Михаил Зыгарь",
    "Иван Ключарёв",
    "Андрей Лошак",
    "Павел Лобков",
    "Лилия Чанышева",
    "Сергей Смирнов",
    "Илья Яшин",
    "Олег Кашин",
    "Сергей Пархоменко",
    "Татьяна Лазарева",
    "Сергей Гуриев",
    "Константин Эггерт",
    "Сергей Алексашенко",
    "Игорь Яковенко",
    "Александр Баунов",
    "Григорий Свердлин",
    "Валерий Печейкин",
    "Юрий Дудь",
    "Роман Доброхотов",
    "Алексей Пивоваров",
    "Канал Redakciya",
    "Пётр Верзилов",
    "Надежда Толоконникова",
    "Мария Алехина",
    "Pussy Riot",
    "Оксана Баулина",
    "Артемий Троицкий",
    "Аркадий Бабченко",
    "Эхо Москвы",
    "Новая Газета",
    "Новая Газета Европа",
    "Новая История",
    "Независимая Газета",
    "Сноб",
    "Такие дела",
    "Холод",
    "iStories (Важные истории)",
    "7x7",
    "Псковская губерния",
    "Сота",
    "Альберт Михалев",
    "Татьяна Фельгенгауэр",
    "Илья Азар",
    "Светлана Прокопьева",
    "Михаил Фишман",
    "Андрей Бильжо",
    "Дмитрий Быков",
    "Дмитрий Муратов",
    "Лев Шлосберг",
    "Елена Милашина",
    "Александр Плющев",
    "Антон Орехъ",
    "Николай Картозия",
    "Ирина Шихман",
    "Наталья Синдеева",
    "Канал Дождь",
    "Канал Навальный Live",
    "Канал Популярная политика",
    "Канал Ходорковский Live",
    "Канал Русский агент",
    "Канал Кашин",
    "Канал Шрёдингер",
    "Канал Varvara",
    "Канал SHULMAN",
    "Канал Нино Росебашвили",
    "Канал Спец",
    "Канал Bild на русском",
    "Канал Версус",
    "Канал Майор и Генерал",
    "Канал Живой Гвоздь",
    "Канал Латвия24",
    "Канал ВДудь",
    "Канал Max KATZ",
    "Канал OPEN Media",
    "Канал редакция",
    "Канал ГУЛАГу.net",
    "Канал Dissernet",
    "Канал Proekt.Media",
    "Канал Conflict Intelligence Team",
    "Канал Feminist Anti-War Resistance",
    "Канал Free Russia Foundation",
    "Канал Meduza",
    "Канал OVD-Info",
    "Канал Safehouse",
    "Канал Support for Political Prisoners. Memorial",
    "Канал Team Navalny",
    "Канал Verstka",
    "Канал Волна",
    "Канал Голос Америки",
    "Канал Idel.Реалии",
    "Канал Кавказ.Реалии",
    "Канал Крым.Реалии",
    "Канал Радио Свобода",
    "Канал Сибирь.Реалии",
    "Канал Sever.Realii",
    "Канал Южная Сеть",
    "Канал Эхо",
    "Канал Эхо Москвы",
    "Канал Эхо. Новости", "Абдурахманов Тумсу Умалтович",
  "Абишев Илья Еркенович",
  "Агалакова Жанна Леонидовна",
  "Агафонова Елена Владимировна",
  "Агумава Фидель Эдуардович",
  "Адагамов Рустем Ринатович",
  "Азар Илья Вильямович",
  "Айнбиндер Александра Александровна",
  "Айсин Руслан Валерьевич",
  "Аксенов Андрей Николаевич",
  "Албуров Георгий Валентинович",
  "Александрова-Зорина Елизавета Борисовна",
  "Алексашенко Сергей Владимирович",
  "Алексеев Андрей Викторович",
  "Алексеев Иван Александрович",
  "Алесин Денис Владимирович",
  "Алешковский Дмитрий Петрович",
  "Аллеман Ирина Владимировна",
  "Альбац Евгения Марковна",
  "Андреева Мария Борисовна",
  "Анин Роман Александрович",
  "Антонов Сергей Юрьевич",
  "Апахончич Дарья Александровна",
  "Апресян Рубен Грантович",
  "Апухтина Юлия Владимировна",
  "Арапова Галина Юрьевна",
  "Артемьев Игорь Андреевич",
  "Архангельский Александр Николаевич",
  "Архипова Александра Сергеевна",
  "Арцуев Аслан Хамзатович",
  "Аршба Низфа Дарисмановна",
  "Асафьев Артур Валерьевич",
  "Аскеров Ровшан Энвер оглы",
  "Асланян Сергей Степанович",
  "Асташин Иван Игоревич",
  "Ауслендер Сергей Дмитриевич",
  "Афанасьев Андрей Андреевич",
  "Афанасьева Вера Владимировна",
  "Баблоян Ирина Арамовна",
  "Бабченко Аркадий Аркадьевич",
  "Баданин Роман Сергеевич",
  "Баев Андрей Сергеевич",
  "Бакалейко Богдан Владимирович",
  "Балтатарова Евгения Семеновна",
  "Балунов Александр Валентинович",
  "Барабанов Илья Алексеевич",
  "Барабаш Екатерина Юрьевна",
  "Барабашова Любовь Григорьевна",
  "Баранова Наталья Владимировна",
  "Барановский Алексей Александрович",
  "Барбашин Антон Игоревич",
  "Баршева Оксана Андреевна",
  "Баунов Александр Германович",
  "Бекбулатова Таисия Львовна",
  "Беленькая Марианна Борисовна",
  "Белик Александр Еленович",
  "Белковский Станислав Александрович",
  "Белокиев Ислам Русланович",
  "Белоцерковская Вероника Борисовна",
  "Белый Руслан Викторович",
  "Беляев Иван Михайлович",
  "Беляева Нина Александровна",
  "Беляков Данила Валерьевич",
  "Беньяш Михаил Михайлович",
  "Бер Илья Леонидович",
  "Березовец Тарас Валерьевич",
  "Беседина Дарья Станиславовна",
  "Биккинин Ирек Дамирович",
  "Богданова Дарья Алексеевна",
  "Бойко Сергей Андреевич",
  "Бондарев Борис Анатольевич",
  "Борзунова Мария Михайловна",
  "Боровой Константин Натанович",
  "Бортник Егор Михайлович",
  "Борухович Ирина Григорьевна",
  "Босов Катерина Евгеньевна",
  "Боссарт Алла Борисовна",
  "Бровков Артем Андреевич",
  "Буракова Анастасия Андреевна",
  "Бусыгина Ирина Марковна",
  "Быков Дмитрий Львович",
  "Ваганов Вадим Александрович",
  "Важенков Артем Валерьевич",
  "Вайпан Григорий Викторович",
  "Вайсман Анатолий Александрович",
  "Варламов Илья Александрович",
  "Вахштайн Виктор Семенович",
  "Вачагаев Майрбек Момуевич",
  "Великовский Дмитрий Александрович",
  "Веллер Михаил Иосифович",
  "Венедиктов Алексей Алексеевич",
  "Венявкин Илья Геннадиевич",
  "Верзилов Петр Юрьевич",
  "Ветошкина Валерия Валерьевна",
  "Винатье Лоран Клод Жан-Луи",
  "Вихарева Эльвира Владимировна",
  "Вишневский Борис Лазаревич",
  "Владыкина Елена Сергеевна",
  "Водвуд Вераника Сергеевна",
  "Волков Леонид Михайлович",
  "Волна Андрей Анатольевич",
  "Волобуев Игорь Михайлович",
  "Волохонский Владимир Львович",
  "Вольтская Татьяна Анатольевна",
  "Воробьев Виктор Викторович",
  "Воронов Владимир Владимирович",
  "Вотановский Виталий Викторович",
  "Вырыпаев Иван Александрович",
  "Габбасов Руслан Салаватович",
  "Габуев Александр Тамерланович",
  "Гаджиев Магомед Тажудинович",
  "Галкин Максим Александрович",
  "Галлямов Аббас Радикович",
  "Галямина Юлия Евгеньевна",
  "Ганапольский Матвей Юрьевич",
  "Ганнушкина Светлана Алексеевна",
  "Гармажапова Александра Цыреновна",
  "Гатов Василий Викторович",
  "Гельман Марат Александрович",
  "Генис Александр Александрович",
  "Герасименко Олеся Михайловна",
  "Гершензон Лев Михайлович",
  "Гималова Регина Эмилевна",
  "Гликин Максим Александрович",
  "Глуховский Дмитрий Алексеевич",
  "Гозман Леонид Яковлевич",
  "Голубева Анастасия Павловна",
  "Голубева Анна Львовна",
  "Гольдшмидт Филипп",
  "Гончаров Василий Владимирович",
  "Горалик Линор-Джулия",
  "Горбачев Александр Витальевич",
  "Гордеева Катерина Владимировна",
  "Гордон Дмитрий Ильич",
  "Горпинченко Алексей Вячеславович",
  "Гребенщиков Борис Борисович",
  "Грезев Александр Викторович",
  "Григорьев Андрей Валерьевич",
  "Григорьева Алина Александровна",
  "Грозев Христо",
  "Гройсман Софья Романовна",
  "Грязневич Наталья Владимировна",
  "Губанов Алексей Александрович",
  "Губарев Даниил Евгеньевич",
  "Губин Дмитрий Павлович",
  "Гудков Геннадий Владимирович",
  "Гудков Дмитрий Геннадьевич",
  "Гудков Лев Дмитриевич",
  "Гуляев Сергей Владимирович",
  "Гуриев Сергей Маратович",
  "Гурман Юрий Альбертович",
  "Гусев Андрей Юрьевич",
  "Гырдымова Елизавета Андреевна",
  "Давлетгильдеев Ринат Маратович",
  "Давлятчин Илья Владимирович",
  "Давыдов Дмитрий Викторович",
  "Данилович Ирина Брониславовна",
  "Дарбинян Саркис Симонович",
  "Дзугкоева Регина Николаевна",
  "Дзядко Тихон Викторович",
  "Доброхотов Роман Александрович",
  "Довданов Владимир Анатольевич",
  "Докучаев Алексей Алексеевич",
  "Долин Антон Владимирович",
  "Долинина Ирина Николаевна",
  "Доможиров Евгений Валерьевич",
  "Дорохов Владимир Юрьевич",
  "Дремин Иван Тимофеевич",
  "Дубровский Дмитрий Викторович",
  "Дудко Екатерина Артуровна",
  "Дудь Юрий Александрович",
  "Дунцова Екатерина Сергеевна",
  "Дымарский Виталий Наумович",
  "Егоров Владимир Владимирович",
  "Ежов Михаил Анатольевич",
  "Ежов Сергей Александрович",
  "Еланчик Олег Александрович",
  "Елкин Сергей Владимирович",
  "Еловский Дмитрий Сергеевич",
  "Жадаев Иван Алексеевич",
  "Жвик Анастасия Николаевна",
  "Жданов Иван Юрьевич",
  "Железнова Мария Михайловна",
  "Живица Владислав Геннадьевич",
  "Жилинский Владимир Александрович",
  "Жилкин Владимир Владимирович",
  "Жирнов Сергей Олегович",
  "Жуковский Владислав Сергеевич",
  "Затирко Андрей Викторович",
  "Захаров Андрей Вячеславович",
  "Заякин Андрей Викторович",
  "Зимин Борис Дмитриевич",
  "Зицер Вадим Семенович",
  "Зубов Андрей Борисович",
  "Зудиева Лутфие Ремзиевна",
  "Зуева Анна Сергеевна",
  "Зыгарь Михаил Викторович",
  "Иванов Дмитрий Сергеевич",
  "Иванов Павел Викторович",
  "Иванова София Юрьевна",
  "Ивлева-Йорк Виктория Марковна",
  "Ившина Ольга Яковлевна",
  "Илларионов Андрей Николаевич",
  "Илюхин Сергей Валерьевич",
  "Иноземцев Владислав Леонидович",
  "Ишутин Кирилл Валерьевич",
  "Каверзина Светлана Викторовна",
  "Кавказский Николай Юрьевич",
  "Кагарлицкий Борис Юльевич",
  "Казанцева Александра Николаевна",
  "Казанцева Анастасия Андреевна",
  "Камалягин Денис Николаевич",
  "Канкия Давид Николаевич",
  "Каныгин Павел Юрьевич",
  "Кара-Мурза Владимир Владимирович",
  "Караулов Андрей Викторович",
  "Карезина Инна Павловна",
  "Каретникова Анна Георгиевна",
  "Карпов Евгений Вячеславович",
  "Карпук Руслан Леонидович",
  "Картавин Антон Викторович",
  "Каруличева Анна Николаевна",
  "Каспаров Гарри Кимович",
  "Касьянов Михаил Михайлович",
  "Катаев Денис Сергеевич",
  "Каткова Вероника Вячеславовна",
  "Кац Максим Евгеньевич",
  "Качанов Роман Романович",
  "Качур Кирилл Витальевич",
  "Кашапов Рафис Рафаилович",
  "Кашин Олег Владимирович",
  "Кашинцев Олег Вячеславович",
  "Кен Даниил Олегович",
  "Кильтау Екатерина Викторовна",
  "Кириллов Никита Никитович",
  "Кирия Ксения Дмитриевна",
  "Кирсанов Сергей Владимирович",
  "Киселев Евгений Алексеевич",
  "Кисин Евгений Игоревич",
  "Клепиковская Екатерина Дмитриевна",
  "Климарев Михаил Валерьевич",
  "Климов Антон Михайлович",
  "Климов Максим Евгеньевич",
  "Ковалев Алексей Андреевич",
  "Ковальченко Сергей Владимирович",
  "Ковин Виталий Сергеевич",
  "Козенко Андрей Дмитриевич",
  "Козловский Станислав Александрович",
  "Козырев Андрей Владимирович",
  "Козырев Михаил Натанович",
  "Колдобский Сергей Григорьевич",
  "Колезев Дмитрий Евгеньевич",
  "Колесников Андрей Владимирович",
  "Колмановский Илья Александрович",
  "Комелев Алексей Юрьевич",
  "Комин Михаил Олегович",
  "Комиссаров Станислав Андреевич",
  "Кондакова Саргылана Константиновна",
  "Конопелькин Антон Сергеевич",
  "Константинов Даниил Ильич",
  "Константинов Денис Владимирович",
  "Константинова Алла Михайловна",
  "Королёв Андрей Владимирович",
  "Костылева Полина Владимировна",
  "Косыгин Илья Евгеньевич",
  "Котляров Владимир Андреевич",
  "Котрикадзе Екатерина Бесикиевна",
  "Кочегин Евгений Сергеевич",
  "Кочесоков Мартин Хусенович",
  "Кочетков Игорь Викторович",
  "Кочкин Семен Александрович",
  "Крашенинников Федор Геннадиевич",
  "Кривенко Сергей Владимирович",
  "Кругликов Кирилл Игоревич",
  "Крутихин Михаил Иванович",
  "Куваев Олег Игоревич",
  "Кузахметов Максим Рафикович",
  "Кузьмин Николай Александрович",
  "Кузьмина Людмила Гавриловна",
  "Кукушкин Никита Андреевич",
  "Кунгуров Алексей Анатольевич",
  "Кураев Андрей Вячеславович",
  "Курбангалеева Фарида Рашидовна",
  "Курманакаев Анвар Мусабиевич",
  "Куршин Андрей Владимирович",
  "Куцылло Вероника Иосифовна",
  "Кучер Станислав Александрович",
  "Кушнарь Александр Александрович",
  "Лада-Русь Светлана Михайловна",
  "Лазарева Татьяна Юрьевна",
  "Латынина Юлия Леонидовна",
  "Латыпов Роберт Рамилевич",
  "Левшиц Николай Дмитриевич",
  "Лекманов Олег Андершанович",
  "Лешкевич Владислав Валерьевич",
  "Либеров Роман Александрович",
  "Липсиц Игорь Владимирович",
  "Лирник Антон Анатольевич",
  "Литвин Богдан Геннадьевич",
  "Литвинов Александр Сергеевич",
  "Литвинович Марина Алексеевна",
  "Лобанов Михаил Сергеевич",
  "Лойко Сергей Леонидович",
  "Лотарева Анастасия Александровна",
  "Лошак Андрей Борисович",
  "Лукьянова Елена Анатольевна",
  "Лукьянова Юлия Сергеевна",
  "Лученко Ксения Валерьевна",
  "Лушников Алексей Германович",
  "Лушникова Екатерина Евгеньевна",
  "Львов Андрей Генриевич",
  "Любарев Аркадий Ефимович",
  "Любимов Дмитрий Александрович",
  "Лютов Александр Иванович",
  "Маетная Елизавета Витальевна",
  "Макаревич Андрей Вадимович",
  "Макашенец Александр Юрьевич",
  "Максакова-Игенбергс Мария Петровна",
  "Малаховская Елена Владимировна",
  "Малкова Ирина Владимировна",
  "Малов Алексей Владимирович",
  "Мальгин Андрей Викторович",
  "Мальцев Вячеслав Вячеславович",
  "Манский Виталий Всеволодович",
  "Маняхин Петр Борисович",
  "Марголис Екатерина Леонидовна",
  "Маркелов Сергей Евгеньевич",
  "Мароховская Алеся Алексеевна",
  "Мартыненко Тимофей Сергеевич",
  "Мартынов Кирилл Константинович",
  "Маршенкулова Залина Хамидовна",
  "Матвеев Илья Александрович",
  "Матвеев Ян Андреевич",
  "Матвейченков Максим Владимирович",
  "Маяковская Екатерина Алексеевна",
  "Медведев Артем Павлович",
  "Медведев Сергей Александрович",
  "Медведев Сергей Юрьевич",
  "Мезерин Павел Владимирович",
  "Меньшиков Андрей Владимирович",
  "Милов Владимир Станиславович",
  "Минкин Александр Викторович",
  "Митрохин Николай Александрович",
  "Михнов-Вайтенко Григорий Александрович",
  "Монгайт Анна Викторовна",
  "Моргенштерн Алишер Тагирович",
  "Морев Андрей Зиновьевич",
  "Морозов Александр Олегович",
  "Муждабаев Айдер Иззетович",
  "Мунтян Павел Андреевич",
  "Мурадов Мурад Абдулгалимович",
  "Муратов Дмитрий Андреевич",
  "Мурзагулов Ростислав Рафкатович",
  "Набутов Кирилл Викторович",
  "Наки Майкл Сидней",
  "Намазбаева Татьяна Валерьевна",
  "Наринская Анна Анатольевна",
  "Невзлин Леонид Борисович",
  "Невзоров Александр Глебович",
  "Некрасов Дмитрий Александрович",
  "Низовцев Дмитрий Александрович",
  "Никандров Марат Игоревич",
  "Никульшина Вероника Юрьевна",
  "Новашов Андрей Валерьевич",
  "Новиков Илья Сергеевич",
  "Обухов Герман Викторович",
  "Олейник Владислав Александрович",
  "Оленичев Максим Владимирович",
  "Омбадыков Эрдни Басан",
  "Орешкин Дмитрий Борисович",
  "Орлов Олег Петрович",
  "Осетинская Елизавета Николаевна",
  "Осечкин Владимир Валерьевич",
  "Осипова Светлана Витальевна",
  "Осмоловский Анатолий Феликсович",
  "Осовцов Александр Авраамович",
  "Охотин Григорий Никитич",
  "Павлов Андрей Васильевич",
  "Павлов Иван Юрьевич",
  "Панюшкин Валерий Валерьевич",
  "Парамонова Юлия Борисовна",
  "Парменов Никита Владимирович",
  "Пархоменко Сергей Борисович",
  "Пастухов Владимир Борисович",
  "Пахалюк Константин Александрович",
  "Певчих Мария Константиновна",
  "Пелевина Наталья Владиславовна",
  "Перл Роман Александрович",
  "Петров Алексей Викторович",
  "Петров Николай Владимирович",
  "Петров Степан Юрьевич",
  "Пивоваров Алексей Владимирович",
  "Пивоваров Юрий Сергеевич",
  "Пигалкин Илья Валерьевич",
  "Пионтковский Андрей Андреевич",
  "Пирогова Хельга Вадимовна",
  "Пискунов Сергей Евгеньевич",
  "Плющев Александр Владимирович",
  "Подольская Ольга Валерьевна",
  "Покровский Максим Сергеевич",
  "Поливанова Александра Владимировна",
  "Полозов Николай Николаевич",
  "Понасенков Евгений Николаевич",
  "Пономарев Илья Владимирович",
  "Пономарев Лев Александрович",
  "Поночевный Игорь Васильевич",
  "Поперечный Данила Алексеевич",
  "Попова Алена Владимировна",
  "Постернак Алексей Евгеньевич",
  "Потапенко Дмитрий Валерьевич",
  "Преображенский Иван Сергеевич",
  "Продайвода Алексей Владимирович",
  "Прокашева Елена Владимировна",
  "Прокопенко Александра Сергеевна",
  "Прокопьева Светлана Владимировна",
  "Прохоров Вадим Юрьевич",
  "Прусикин Илья Владимирович",
  "Прянишников Алексей Александрович",
  "Пуркин Дмитрий Николаевич",
  "Пшеничная Анна Эдуардовна",
  "Пьяных Глеб Валентинович",
  "Радзинский Олег Эдвардович",
  "Раевский Владимир Евгеньевич",
  "Ракша Алексей Игоревич",
  "Рамазанова Земфира Талгатовна",
  "Распутин Ярослав Иванович",
  "Раткин Альберт Викторович",
  "Ратникова Валерия Евгеньевна",
  "Рачинский Ян Збигневич",
  "Резник Максим Львович",
  "Ривина Анна Валерьевна",
  "Рогов Кирилл Юрьевич",
  "Роднянский Александр Ефимович",
  "Рождественский Илья Дмитриевич",
  "Ройзман Евгений Вадимович",
  "Ромалийская Ирина Геннадьевна",
  "Романова Ольга Евгеньевна",
  "Роменский Владимир Андреевич",
  "Рубин Антон Борисович",
  "Рубин Михаил Аркадьевич",
  "Рувинский Владимир Владимирович",
  "Рудакова Диана Борисовна",
  "Рудой Андрей Владимирович",
  "Рыклин Александр Юрьевич",
  "Сабунаева Мария Леонидовна",
  "Савва Михаил Валентинович",
  "Савельев Александр Валерьевич",
  "Савицкая Людмила Алексеевна",
  "Свердлин Григорий Сергеевич",
  "Светов Михаил Владимирович",
  "Севец-Ермолина Наталья Федоровна",
  "Седов Кирилл Вадимович",
  "Семенов Алексей Владимирович",
  "Серегин Алексей Александрович",
  "Серенко Дарья Андреевна",
  "Сидельников Андрей Александрович",
  "Симонов Евгений Алексеевич",
  "Синдеева Наталья Владимировна",
  "Синеокая Юлия Вадимовна",
  "Сироткин Ярослав Николаевич",
  "Скворцова Елена Сергеевна",
  "Скобов Александр Валерьевич",
  "Слабых Игорь Игоревич",
  "Слепаков Семен Сергеевич",
  "Сливяк Владимир Владимирович",
  "Смагин Никита Анатольевич",
  "Смирнов Александр Александрович",
  "Смирнов Сергей Сергеевич",
  "Смольянинов Артур Сергеевич",
  "Снеговая Мария Владиславовна",
  "Соболев Николай Юрьевич",
  "Соболь Любовь Эдуардовна",
  "Соколов Антон Сергеевич",
  "Соколов Денис Владимирович",
  "Соколов Михаил Владимирович",
  "Соколов Никита Павлович",
  "Солдатов Андрей Алексеевич",
  "Соловей Валерий Дмитриевич",
  "Соловьева Елена Анатольевна",
  "Сонин Константин Исаакович",
  "Сотников Даниил Владимирович",
  "Сотникова Татьяна Александровна",
  "Спирин Дмитрий Александрович",
  "Становая Татьяна Анатольевна",
  "Степанов Олег Олегович",
  "Степанов Сергей Николаевич",
  "Сторожева Ирина Владимировна",
  "Ступин Евгений Викторович",
  "Суворкин Антон Владимирович",
  "Суляндзига Павел Васильевич",
  "Супер Роман Владимирович",
  "Сурначева Елизавета Дмитриевна",
  "Сусолкин Константин Александрович",
  "Суханов Алексей Станиславович",
  "Сухарев Дмитрий Вадимович",
  "Счастливая Дарья Владимировна",
  "Тагаева Лола Маджидовна",
  "Таратута Юлия Леонидовна",
  "Татулова Анастасия Анатольевна",
  "Телегина Наталия Геннадьевна",
  "Телин Федор Алексеевич",
  "Тимонов Михаил Леонидович",
  "Тимченко Галина Викторовна",
  "Тиньков Олег Юрьевич",
  "Тихонов Михаил Сергеевич",
  "Толоконникова Надежда Андреевна",
  "Толстой Святослав Георгиевич",
  "Ториев Магомед Идрисович",
  "Трескунов Семён Алексеевич",
  "Трещанин Дмитрий Евгеньевич",
  "Троицкий Артемий Кивович",
  "Трошин Сергей Александрович",
  "Троянова Яна Александровна",
  "Трудолюбов Максим Анатольевич",
  "Тютрин Иван Иванович",
  "Узаров Хасан Ганиевич",
  "Улицкая Людмила Евгеньевна",
  "Урушадзе Георгий Фридонович",
  "Усанова Олимпиада Валентиновна",
  "Устимов Антон Михайлович",
  "Уткин Федор Викторович",
  "Ухов Сергей Анатольевич",
  "Федоров Кирилл Владимирович",
  "Федоров Мирон Янович",
  "Федоров Юрий Евгеньевич",
  "Федоровых Арина Эдуардовна",
  "Фейгин Марк Захарович",
  "Фельдман Евгений Олегович",
  "Фельштинский Юрий Георгиевич",
  "Филимонов Андрей Викторович",
  "Филиппов Иван Борисович",
  "Фишман Михаил Владимирович",
  "Фохт-Бабушкина Елизавета Антоновна",
  "Фурсов Анатолий Владимирович",
  "Харатьян Кирилл Евгеньевич",
  "Харченко Вадим Михайлович",
  "Хашиг Инал Николаевич",
  "Хейкинен Дарья Дмитриевна",
  "Хисамова Регина Фаритовна",
  "Ходорковский Михаил Борисович",
  "Хржановский Илья Андреевич",
  "Цветкова Юлия Владимировна",
  "Цибирев Дмитрий Александрович",
  "Цимбалюк Роман Владимирович",
  "Цуканова Ольга Викторовна",
  "Чаниа Изида Терентьевна",
  "Чентемиров Георгий Ростиславович",
  "Черепанова Ксения Федоровна",
  "Черкасов Александр Владимирович",
  "Чернышев Дмитрий Александрович",
  "Чернышов Сергей Андреевич",
  "Чиков Павел Владимирович",
  "Чимаров Михаил Юрьевич",
  "Чирикова Евгения Сергеевна",
  "Чистякова Мария Владимировна",
  "Чичваркин Евгений Александрович",
  "Чуракова Ольга Владимировна",
  "Чхартишвили Григорий Шалвович",
  "Шаблинский Илья Георгиевич",
  "Шаведдинов Руслан Табризович",
  "Шадрина Татьяна Владимировна",
  "Шаинян Карен Багратович",
  "Шакиров Мумин Шакирович",
  "Шац Михаил Григорьевич",
  "Шведов Григорий Сергеевич",
  "Швец Юрий Борисович",
  "Шевченко Анастасия Нукзариевна",
  "Шеин Олег Васильевич",
  "Шейтельман Михаил",
  "Шелест Александр",
  "Шендерович Виктор Анатольевич",
  "Шепелин Илья Андреевич",
  "Ширяев Вячеслав Эдуардович",
  "Шихман Ирина Юрьевна",
  "Шишкин Михаил Павлович",
  "Шлейнов Роман Юрьевич",
  "Шлосберг Лев Маркович",
  "Шмагун Олеся Валентиновна",
  "Шмурнов Александр Иванович",
  "Шпак Александр Константинович",
  "Шпилькин Сергей Александрович",
  "Штефанов Александр Андреевич",
  "Шукаева Елена Викторовна",
  "Шульман Екатерина Михайловна",
  "Шуманов Илья Вячеславович",
  "Шуршев Александр Олегович",
  "Щербакова Ирина Лазаревна",
  "Эггерт Константин Петрович",
  "Эйдельман Тамара Натановна",
  "Эйдман Игорь Виленович",
  "Экслер Алексей Борисович",
  "Эппле Николай Владимирович",
  "Эткинд Александр Маркович",
  "Юдин Григорий Борисович",
  "Юсупов Идрис Гасан-Гусейнович",
  "Яганов Ибрагим Хасанбиевич",
  "Яковенко Игорь Александрович",
  "Яковина Иван Викторович",
  "Янковский Аркадий Эдуардович",
  "Ярмыш Кира Александровна",
  "Ярош Юлия Петровна",
  "Ясавеев Искэндэр Габдрахманович",
  "Яшин Илья Валерьевич",
  "Общество с ограниченной ответственностью «ЕЛКИН КАРТОН»",
  "Ресурсный центр для ЛГБТ",
  "Телеканал Дождь",
  "Anti-Corruption Foundation Inc.",
  "Deutsche Welle",
  "Hidemy.network Ltd.",
  "MRR-Fund gemeinnützige UG (haftungsbeschränkt), реализующий проект My Russian Rights",
  "The Bell",
  "«BILD на русском»",
  "«Idel.Реалии»",
  "«Голос Америки»",
  "«Движение сознательных отказчиков»",
  "«ЕЖ LAB» («BRIEF Важное», «Незыгаревский», «ЕЖ/главное», «ЕЖ главное»)",
  "«ЕЖ» («BRIEF», «ЕЖ/дневник»)",
  "«Евразийская антимонопольная ассоциация»",
  "«Земский съезд»",
  "«Кедр.медиа»",
  "«Коалиция Новосибирск 2020»",
  "«Комитет ингушской независимости»",
  "«Кризисная группа СК SOS» (North Caucasus SOS Crisis Group)",
  "«Молодежное демократическое движение «Весна»",
  "«Москва против мобилизации»",
  "«НЕЗЫГАРЬ» («Незыгарь», «НЕЗЫГАР», «НЕЗЫГАР@», «НZГ. Russica», «HZГ»)",
  "«Настоящая Россия»",
  "«Общенародный Союз Возрождения России»",
  "«Радужная ассоциация»",
  "«Российское социалистическое движение» (РСД)",
  "«Русский криминал», «ВЧК-ОГПУ»",
  "«Север.Реалии»",
  "«Сибирь.Реалии»",
  "«Сирена»",
  "«Смола» («Smola»)",
  "«Совет матерей и жен»",
  "«Теплица социальных технологий»",
  "«Фактограф»",
  "«Феминистское Антивоенное Сопротивление»",
  "«Частное учреждение в Калининграде по административной поддержке реализации программ и проектов Совета Министров северных стран»",
  "«Частное учреждение в Санкт-Петербурге по административной поддержке реализации программ и проектов Совета Министров северных стран»",
  "АССОЦИАЦИЯ «СОДЕЙСТВИЕ В ПРАВОВОЙ ЗАЩИТЕ НАСЕЛЕНИЯ «ПРАВОВАЯ ОСНОВА»",
  "Автономная Некоммерческая Организация «Аналитический Центр Юрия Левады»",
  "Автономная некоммерческая организация содействия улучшению качества жизни людей из групп социального риска «Право каждого»",
  "Автономная некоммерческая научно-исследовательская организация «Центр социальной политики и гендерных исследований»",
  "Автономная некоммерческая общеобразовательная организация «Англо-американская школа Москвы»",
  "Автономная некоммерческая организация «Институт прав человека»",
  "Автономная некоммерческая организация «Юристы за конституционные права и свободы»",
  "Автономная некоммерческая организация «Друзья Балтики»",
  "Автономная некоммерческая организация «Центр по работе с проблемой насилия» («НАСИЛИЮ.НЕТ»)",
  "Автономная некоммерческая организация «Ганзейское бюро/Информационное бюро земли Шлезвиг-Гольштейн в Калининграде»",
  "Автономная некоммерческая организация «Дальневосточный центр развития гражданских инициатив и социального партнерства»",
  "Автономная некоммерческая организация «Издательский дом «Валентин Мануйлов»",
  "Автономная некоммерческая организация «Издательство «Парк Гагарина»",
  "Автономная некоммерческая организация «Институт глобализации и социальных движений»",
  "Автономная некоммерческая организация «Институт права и публичной политики»",
  "Автономная некоммерческая организация «Информационно-исследовательский центр «Ясавэй Манзара»",
  "Автономная некоммерческая организация «Мемориальный центр истории политических репрессий «Пермь-36»",
  "Автономная некоммерческая организация «Московская школа гражданского просвещения»",
  "Автономная некоммерческая организация «Научный центр международных исследований «ПИР»",
  "Автономная некоммерческая организация «Нижегородский центр немецкой и европейской культуры»",
  "Автономная некоммерческая организация «Правозащитная организация «МАШР»",
  "Автономная некоммерческая организация «Свободное слово»",
  "Автономная некоммерческая организация «Центр антикоррупционных исследований и инициатив «Трансперенси Интернешнл-Р»",
  "Автономная некоммерческая организация «Центр информации «ФРИИНФОРМ»",
  "Автономная некоммерческая организация «Центр независимых социологических исследований»",
  "Автономная некоммерческая организация «Центр сохранения и изучения лососевых видов рыб и мест их обитания»",
  "Автономная некоммерческая организация «Центр социально-трудовых прав»",
  "Автономная некоммерческая организация «Центр социального проектирования «Возрождение»",
  "Автономная некоммерческая организация Краснодарский центр современного искусства «Типография»",
  "Автономная некоммерческая организация Центр развития социальных инициатив «Проектория»",
  "Автономная некоммерческая организация для издания научно-популярной газеты «ТРОИЦКИЙ ВАРИАНТ-НАУКА»",
  "Автономная некоммерческая организация информационных и правовых услуг «Гражданская инициатива против экологической преступности»",
  "Автономная некоммерческая организация информационных и правовых услуг «Ресурсный правозащитный центр»",
  "Автономная некоммерческая организация по защите прав человека и информированию населения «Якутия – Наше Мнение»",
  "Автономная некоммерческая организация по оказанию услуг в области защиты прав человека «Молодежная правозащитная группа»",
  "Автономная некоммерческая организация по реализации социально-правовых программ «Лилит»",
  "Автономная некоммерческая организация по содействию распространению современных образовательных программ «Лаборатория социальных наук»",
  "Автономная некоммерческая организация противодействия эпидемии ВИЧ/СПИДа и охраны здоровья социально-уязвимых групп населения «Центр социально-информационных инициатив Действие»",
  "Автономная некоммерческая организация социально-правовых услуг «Акцент»",
  "Автономная некоммерческая организация социально-спортивных программ «Спортивное ЛГБТ-сообщество»",
  "Автономная некоммерческая организация социальной поддержки населения «Проект Апрель»",
  "Автономная некоммерческая правозащитная организация «Школа призывника»",
  "Автономная некоммерческая правозащитная организация «Молодежный центр консультации и тренинга»",
  "Акционерное общество «РС-Балт»",
  "Алтайская краевая общественная организация «Геблеровское экологическое общество»",
  "Алтайская краевая общественная просветительская организация в сфере охраны здоровья «Выбор»",
  "Алтайская региональная спортивно-патриотическая молодежная общественная организация «Арктика»",
  "Алтайский краевой эколого-культурный общественный фонд «Алтай-21век»",
  "Алтайское краевое общественное движение поддержки гражданских и социальных инициатив «Согласие»",
  "Альянс гетеросексуалов и ЛГБТ за равноправие",
  "Американская компания «Mason G.E.S. Anonymous Foundation»",
  "Антивоенное этническое движение «Новая Тыва» (New Tuva)",
  "Архангельская региональная молодежная экологическая общественная организация «Этас»",
  "Архангельская региональная общественная организация социально-психологической и правовой помощи лесбиянкам, геям, бисексуалам и трансгендерам (ЛГБТ) «Ракурс»",
  "Ассоциация «Интернет Сообщество»",
  "Ассоциация «Партнерство для развития»",
  "Ассоциация «Экспертно-правовое партнерство «Союз»",
  "Ассоциация некоммерческих организаций «В защиту прав избирателей «ГОЛОС»",
  "Ассоциация по содействию защите прав призывников, альтернативнослужащих и военнослужащих «Правозащитная группа «Гражданин.Армия.Право»",
  "Благотворительный фонд охраны здоровья и защиты прав граждан",
  "Благотворительный фонд помощи осужденным и их семьям",
  "Благотворительный фонд помощи социально-незащищенным гражданам «Нужна помощь»",
  "Благотворительный фонд развития филантропии",
  "Благотворительный фонд социально-правовой помощи «Сфера»",
  "Вологодская региональная общественная организация «Культурно-просветительское общество «Полония»",
  "Городская общественная организация «Екатеринбургское общество «МЕМОРИАЛ»",
  "Городская общественная организация «Рязанское историко-просветительское и правозащитное общество «Мемориал» (Рязанский Мемориал)",
  "Городская общественная организация «Самарский центр гендерных исследований»",
  "Городской благотворительный фонд «Фонд Тольятти»",
  "Дальневосточное общественное движение «Маяк»",
  "Движение «Путь домой»",
  "Еврейское областное региональное отделение Общероссийской общественной организации «Муниципальная Академия»",
  "Женское общественно-политическое движение «Мягкая сила»",
  "Журналистский проект «Адвокатская улица»",
  "Забайкальское краевое общественное учреждение «Общественный экологический центр «Даурия»",
  "Закрытая компания с ограниченной ответственностью «Букмейт Лимитед» (Ирландия)",
  "Издание «Агентство»",
  "Издание «Бумага»",
  "Издание «Гласная»",
  "Издание «Проект»",
  "Ингушская региональная общественная организация «Институт социальных изменений»",
  "Ингушское республиканское отделение Общероссийской общественной организации «Российский Красный Крест»",
  "Инициативная группа ЛГБТ+ «Реверс»",
  "Интернет-журнал и медиаплатформа «7х7 – Горизонтальная Россия»",
  "Интернет-издание «Вёрстка Медиа»",
  "Интернет-издание «The Moscow Times»",
  "Интернет-издание «Довод»",
  "Интернет-издание «Полигон»",
  "Интернет-издание «Холод»",
  "Интернет-портал «ASTRA»",
  "Интернет-проект «SOTA»",
  "Интернет-проект «Объектив»",
  "Информационный портал «ВЕСЬМА»",
  "Иркутская региональная общественная организация «Байкальская Экологическая Волна»",
  "Исследовательский центр «Сова»",
  "Кабардино-Балкарский республиканский общественный правозащитный центр",
  "Кавказ.Реалии",
  "Калининградская региональная общественная организация «Правозащитный центр»",
  "Калининградская региональная общественная организация «Экозащита!-Женсовет»",
  "Калининградская региональная общественная организация информационно-правовых программ «Женская лига»",
  "Калининградская региональная общественная организация содействия развитию женского сообщества «Мир женщины»",
  "Калининградское региональное общественное учреждение «Общество немецкой культуры и российских немцев «Айнтрахт Согласие»",
  "Карачаево-Черкесская Республиканская молодежная общественная организация «Союз молодых политологов»",
  "Команда против пыток (Комитет против пыток)",
  "Компания «Stichting Bellingcat»",
  "Комьюнити-центр «Действие»",
  "Краснодарская краевая общественная организация выпускников вузов",
  "Краснодарская региональная благотворительная общественная организация «Южный правозащитный центр»",
  "Краснодарское краевое отделение Общероссийской общественной организации «Российское историко-просветительское и правозащитное общество «Мемориал»",
  "Красноярская региональная общественная организация «Агентство общественных инициатив»",
  "Красноярская региональная общественная организация «Мы против СПИДа»",
  "Красноярская региональная общественная организация поддержки и развития альтернативных образовательных технологий и межкультурных коммуникаций «ИНТЕРРА»",
  "Красноярское региональное экологическое общественное движение «Друзья сибирских лесов»",
  "Крым.Реалии",
  "Лекторий «Живое слово»",
  "Межрегиональная Ассоциация правозащитных общественных объединений «Правозащитная ассоциация»",
  "Межрегиональная благотворительная общественная организация «Сибирский экологический центр»",
  "Межрегиональная благотворительная общественная организация «Центр развития некоммерческих организаций»",
  "Межрегиональная общественная благотворительная организация «Общество защиты прав потребителей и охраны окружающей среды «ПРИНЦИПЪ»",
  "Межрегиональная общественная организация «Комитет против пыток»",
  "Межрегиональная общественная организация «Северная природоохранная коалиция»",
  "Межрегиональная общественная организация «Бюро общественных расследований»",
  "Межрегиональная общественная организация «Информационно-просветительский центр «Мемориал»",
  "Межрегиональная общественная организация «Комитет по предотвращению пыток»",
  "Межрегиональная общественная организация «Центр гражданского образования и прав человека»",
  "Межрегиональная общественная организация «Центр содействия коренным малочисленным народам Севера»",
  "Межрегиональная общественная организация Правозащитный Центр «Мемориал»",
  "Межрегиональная общественная организация реализации социально-просветительских инициатив и образовательных проектов «Открытый Петербург»",
  "Межрегиональная общественная правозащитная организация «Человек и Закон»",
  "Межрегиональная природоохранная и правозащитная общественная организация «Экологическая Вахта по Северному Кавказу»",
  "Межрегиональное общественное движение «Российская ЛГБТ - сеть»",
  "Межрегиональный общественный фонд содействия развитию гражданского общества «ГОЛОС – Поволжье»",
  "Межрегиональный общественный экологический фонд «ИСАР-СИБИРЬ»",
  "Межрегиональный профессиональный союз работников здравоохранения «Альянс врачей»",
  "Местная общественная благотворительная экологическая организация Зеленый Мир",
  "Московский комьюнити-центр для ЛГБТ+инициатив",
  "Московский региональный общественный благотворительный фонд «Социальное партнерство»",
  "Мурманская областная общественная организация «Кольский экологический центр»",
  "Мурманская региональная молодежная общественная организация «Гуманистическое движение молодежи»",
  "Мурманская региональная общественная организация «Центр социально-психологической помощи и правовой поддержки жертв дискриминации и гомофобии «Максимум»",
  "Мурманская региональная общественная экологическая организация «Беллона-Мурманск»",
  "Некоммерческая организация «Фонд борьбы с коррупцией»",
  "Некоммерческая организация «Фонд защиты гласности»",
  "Некоммерческая организация «Фонд защиты прав граждан «Штаб»",
  "Некоммерческая организация «Фонд защиты прав граждан»",
  "Некоммерческая организация «Фонд по борьбе с коррупцией»",
  "Некоммерческая организация Международный Фонд развития коренных малочисленных народов Севера, Сибири и Дальнего Востока «БАТАНИ»",
  "Некоммерческая организация Фонд «Костромской центр поддержки общественных инициатив»",
  "Некоммерческая организация Фонд «Правовая инициатива»",
  "Некоммерческое партнерство «Альянс фондов местных сообществ Пермского края»",
  "Некоммерческое партнерство «Институт развития прессы-Сибирь»",
  "Некоммерческое партнерство «Институт региональной прессы»",
  "Некоммерческое партнерство «Клуб бухгалтеров и аудиторов некоммерческих организаций»",
  "Некоммерческое партнерство по поддержке социально-профилактических программ в сфере общественного здоровья «ЭСВЕРО»",
  "Некоммерческое партнерство содействия распространению энциклопедических знаний «Викимедиа РУ»",
  "Нижегородская областная социально-экологическая общественная организация «Зеленый мир»",
  "Нижегородская региональная общественная организация «Институт прогнозирования и урегулирования политических конфликтов»",
  "Нижегородская региональная общественная организация «Экологический центр «Дронт»",
  "Новосибирский областной общественный фонд «Фонд защиты прав потребителей»",
  "Общественная организация «Пермский региональный правозащитный центр»",
  "Общероссийская общественная организация содействия развитию автомобильных перевозок «Объединение Перевозчиков России»",
  "Общероссийское общественное движение в защиту прав избирателей «Голос»",
  "Общероссийское общественное движение защиты прав человека «За права человека»",
  "Общественная организация «Омское гражданское объединение»",
  "Общественная организация «Роскомсвобода»",
  "Общественная организация «Санкт-Петербургский Русский ПЕН-клуб»",
  "Общественная организация «Саратовский областной еврейский благотворительный центр «Хасдей Ерушалаим» (Милосердие)",
  "Общественно-политическое движение «Европейский Петербург»",
  "Общественно-политическое движение «Удмуртия против коррупции»",
  "Общественное региональное движение «Новгородский Женский Парламент»",
  "Общество с ограниченной ответственностью «Новогодний выпуск 2023»",
  "Общество с ограниченной ответственностью «ТРАНСМИССИЯ»",
  "Общество с ограниченной ответственностью Издательский дом «Новая глава»",
  "Общество с ограниченной ответственностью «БИТРЭЙ»",
  "Общество с ограниченной ответственностью «ИНОАГЕНТ АВК»",
  "Общество с ограниченной ответственностью «Три «Ч»",
  "Общество с ограниченной ответственностью «Хроникёр»",
  "Общество с ограниченной ответственностью «ВОБНИАР»",
  "Общество с ограниченной ответственностью «АЛАЯ БУКВА»",
  "Общество с ограниченной ответственностью «Альтаир 2021»",
  "Общество с ограниченной ответственностью «Апология»",
  "Общество с ограниченной ответственностью «Апрельские тезисы»",
  "Общество с ограниченной ответственностью «БОЛЬШАЯ СЕМЕРКА»",
  "Общество с ограниченной ответственностью «Важные иноагенты»",
  "Общество с ограниченной ответственностью «Вега 2021»",
  "Общество с ограниченной ответственностью «Вертолет и ко»",
  "Общество с ограниченной ответственностью «Вольные люди»",
  "Общество с ограниченной ответственностью «Время колокольчиков»",
  "Общество с ограниченной ответственностью «Главный редактор 2021»",
  "Общество с ограниченной ответственностью «Город без преград»",
  "Общество с ограниченной ответственностью «Данное сообщение»",
  "Общество с ограниченной ответственностью «ЖУРНАЛИСТ-ИНОСТРАННЫЙ АГЕНТ»",
  "Общество с ограниченной ответственностью «ЗП»",
  "Общество с ограниченной ответственностью «Зона права»",
  "Общество с ограниченной ответственностью «ИНСТИТУТ НЕЙРОКОГНИТИВНЫХ ИССЛЕДОВАНИЙ»",
  "Общество с ограниченной ответственностью «Иноагент ААВ»",
  "Общество с ограниченной ответственностью «Иновещание»",
  "Общество с ограниченной ответственностью «Как бы инагент»",
  "Общество с ограниченной ответственностью «Команда против пыток»",
  "Общество с ограниченной ответственностью «ЛИЗА НОРМ»",
  "Общество с ограниченной ответственностью «ЛПНМ»",
  "Общество с ограниченной ответственностью «ЛЮДИ»",
  "Общество с ограниченной ответственностью «МЕМО»",
  "Общество с ограниченной ответственностью «Нобелевский призыв»",
  "Общество с ограниченной ответственностью «Новогодний выпуск»",
  "Общество с ограниченной ответственностью «Новости»",
  "Общество с ограниченной ответственностью «Номер семьдесят семь»",
  "Общество с ограниченной ответственностью «Первое антикоррупционное СМИ»",
  "Общество с ограниченной ответственностью «Первый научный»",
  "Общество с ограниченной ответственностью «Процесс 2021»",
  "Общество с ограниченной ответственностью «Радио Свободная Европа/Радио Свобода»",
  "Общество с ограниченной ответственностью «Ромашки монолит»",
  "Общество с ограниченной ответственностью «СЧАСТЛИВЫЙ БИЛЕТ»",
  "Общество с ограниченной ответственностью «Собеседник-Медиа»",
  "Общество с ограниченной ответственностью «ТАЙГА ИНФО»",
  "Общество с ограниченной ответственностью «ТЕНЕС»",
  "Общество с ограниченной ответственностью «Философия ненасилия»",
  "Общество с ограниченной ответственностью «Чайка Белые сады»",
  "Общество с ограниченной ответственностью «Честные выборы»",
  "Общество с ограниченной ответственностью «ЯРНОВОСТИ»",
  "Общество с ограниченной ответственностью Телеканал Дождь",
  "Озерская городская социально-экологическая общественная организация «Планета надежд»",
  "Омская городская общественная организация «Фотоклуб «Со-бытие»",
  "Омская региональная общественная организация «Центр охраны здоровья и социальной защиты «СИБАЛЬТ»",
  "Пензенская региональная молодежная общественная организация по профилактике негативных явлений среди молодежи «Панацея»",
  "Пензенский региональный общественный благотворительный фонд «Гражданский союз»",
  "Пермская региональная общественная организация «Пермская гражданская палата»",
  "Пермская региональная общественная организация поддержки и развития медиа-проектов «Четвертый сектор»",
  "Программно-целевой Благотворительный Фонд «СВЕЧА»",
  "Проект «Говорит НеМосква»",
  "Проект «Ковчег»",
  "Проект «Лаборатория университетской прозрачности»",
  "Проект «Можем объяснить»",
  "Проект «Радио Сахаров»",
  "Проект «Ateo»",
  "Проект «Republic»",
  "Проект «T-invariant»",
  "Проект «ВОТ ТАК»",
  "Проект «Гроза»",
  "Проект «Зона солидарности»",
  "Проект «Идите лесом»",
  "Проект «Лаборатория публичной социологии»",
  "Проект «Первый отдел»",
  "Проект «Поддержка политзаключенных. Мемориал»",
  "Проект «Трансперенси Интернешнл-Россия в изгнании»",
  "Проект «Центр «Досье»",
  "Проект для трансгендерных людей и их близких «T9 NSK»",
  "Республиканская молодежная общественная организация «Нуори Карьяла» («Молодая Карелия»)",
  "Радио Свободная Европа/Радио Свобода (PCE/PC)",
  "Региональная национально-культурная общественная организация «Туба калык» (Тубалары)",
  "Региональная общественная благотворительная организация помощи беженцам и мигрантам «Гражданское содействие»",
  "Региональная общественная организация «Еврейский общинный культурный центр Рязанской области «Хесед-Тшува»",
  "Региональная общественная организация «Школа экологии Души «Тенгри»",
  "Региональная общественная организация «Информационно-исследовательский центр «Панорама»",
  "Региональная общественная организация «Общественная комиссия по сохранению наследия академика Сахарова»",
  "Региональная общественная организация «Центр независимых исследователей Республики Алтай»",
  "Региональная общественная организация «Экологическая вахта Сахалина»",
  "Региональная общественная организация Интеграционный центр «Миграция и Закон»",
  "Региональная общественная организация в защиту демократических прав и свобод «ГОЛОС»",
  "Региональная общественная организация по улучшению качества жизни общества «Сибирская линия жизни»",
  "Региональная общественная организация помощи женщинам и детям, находящимся в кризисной ситуации «Информационно-методический центр «Анна»",
  "Региональная общественная организация содействия охране репродуктивного здоровья граждан «Народонаселение и Развитие»",
  "Региональная общественная организация содействия просвещению граждан «Информационно-аналитический центр «Сова»",
  "Региональная общественная организация содействия соблюдению прав человека «Горячая линия»",
  "Региональная общественная правозащитная организация «Союз «Женщины Дона»",
  "Региональная общественная экологическая организация Республики Алтай «Архар»",
  "Региональное общественное учреждение научно-информационный центр «МЕМОРИАЛ»",
  "Региональный благотворительный фонд «Самарская губерния»",
  "Ростовская городская общественная организация «ЭКО-ЛОГИКА»",
  "Самарская общественная организация ЛГБТ+ «Ирида»",
  "Самарская региональная общественная организация «Клуб выпускников американских программ»",
  "Самарская региональная общественная организация содействия гармонизации межнациональных отношений «АЗЕРБАЙДЖАН»",
  "Санкт-Петербургская ЛГБТ-инициативная группа «Выход»",
  "Санкт-Петербургская общественная организация «Общество содействия социальной защите граждан «Петербургская ЭГИДА»",
  "Санкт-Петербургская общественная организация Экологический правозащитный Центр «Беллона»",
  "Санкт-Петербургская общественная правозащитная организация «Гражданский контроль»",
  "Санкт-Петербургская правозащитная общественная организация «Лига избирательниц»",
  "Санкт-Петербургская региональная общественная правозащитная организация «Солдатские матери Санкт-Петербурга»",
  "Санкт-Петербургский благотворительный фонд «Гуманитарное действие»",
  "Саратовская Региональная Общественная Организация «Социум»",
  "Саратовская региональная общественная организация инвалидов, больных сахарным диабетом",
  "Саратовское региональное отделение межрегиональной общественной организации «Евро-Азиатское геофизическое общество»",
  "Свердловская областная общественная организация содействия легальной миграции «Нелегалов.Нет»",
  "Свердловская региональная общественная организация «Сутяжник»",
  "Свердловский областной общественный Фонд «Эра здоровья»",
  "Свердловский региональный общественный фонд социальных проектов «Новое время»",
  "Свердловское отделение Общероссийской общественной организации «Российское историко-просветительское, благотворительное и правозащитное общество «Мемориал»",
  "Социально-ориентированная автономная некоммерческая организация содействия профилактике и охране здоровья граждан «Феникс плюс»",
  "Союз общественных объединений «Российский исследовательский центр по правам человека»",
  "Татаро-башкирская служба Радио Свобода (Azatliq Radiosi)",
  "Телеканал Настоящее Время",
  "Территориальное объединение работодателей «Ефремовский районный союз промышленников и предпринимателей»",
  "Томская региональная общественная организация по защите прав и интересов женщин «Женский голос»",
  "Транс-инициативная группа «Т-Действие»",
  "Фонд «В защиту прав заключенных»",
  "Фонд «Институт Развития Свободы Информации»",
  "Фонд «Институт экономических и социальных исследований»",
  "Фонд «Институт экономического анализа»",
  "Фонд «Общественный фонд социального развития «Генезис»",
  "Фонд «Свободная Бурятия»",
  "Фонд «Свободная Якутия» (Free Yakutia Foundation)",
  "Фонд «Центр гражданского анализа и независимых исследований «ГРАНИ»",
  "Фонд Карнеги за международный мир",
  "Фонд в поддержку демократии «ГОЛОС»",
  "Фонд охраны окружающей среды и защиты животных (Всемирный фонд природы)",
  "Фонд поддержки гражданских свобод «Правовая миссия»",
  "Фонд поддержки расследовательской журналистики – Фонд 19/29",
  "Фонд поддержки свободы прессы",
  "Фонд поддержки социальных проектов «Миграция XXI век»",
  "Фонд развития книжной культуры «Иркутский союз библиофилов»",
  "Фонд развития цифровых прав",
  "Фонд содействия защите здоровья и социальной справедливости имени Андрея Рылькова",
  "Фонд содействия защите прав и свобод граждан «Общественный вердикт»",
  "Фонд содействия правовому просвещению населения «Лига Избирателей»",
  "Фонд содействия развитию гражданского общества и правам человека «Женщины Дона»",
  "Фонд содействия развитию массовых коммуникаций и правовому просвещению «Так-так-Так»",
  "Фонд содействия устойчивому развитию «Серебряная тайга»",
  "Центр Т",
  "Центр защиты прав человека «Мемориал»",
  "Частное учреждение «Информационное агентство МЕМО. РУ»",
  "Частное учреждение «Центр поддержки и содействия развитию средств массовой информации»",
  "Частное учреждение дополнительного профессионального образования «Учебный центр экологии и безопасности»",
  "Челябинский региональный благотворительный общественный фонд «За природу»",
  "Челябинский региональный общественный фонд поддержки демократии «Уральский демократический фонд»",
  "Челябинский региональный орган общественной самодеятельности «Уральская правозащитная группа»",
  "Челябинский региональный орган общественной самодеятельности – женское общественное объединение «Женщины Евразии»",
  "Челябинское региональное диабетическое общественное движение «ВМЕСТЕ»",
  "Челябинское региональное экологическое общественное движение «За природу»",
  "Чешское информационное агентство «MEDIUM-ORIENT»",
  "Школа свободной общественной мысли «Возрождение»",
  "Экологическое движение «42»",
  "Юридическое лицо Istories fonds",
  "Юридическое лицо «The Insider SIA»",
  "Юридическое лицо, зарегистрированное в Королевстве Нидерландов, Stichting 2 Oktober",
  "Юридическое лицо, зарегистрированное в Латвийской Республике, SIA «Medusa Project»"]

TOKEN = os.getenv("BOT_TOKEN")
if not TOKEN:
    raise ValueError("Не найден токен BOT_TOKEN в переменных окружения")

bot = Bot(token=TOKEN)
app = Flask(__name__)
dispatcher = Dispatcher(bot, None, workers=0)

def start(update: Update, context=None):
    update.message.reply_text(
        "🤖 Би-би-боп, Здравствуйте!\n\n"
        "Я бот, который поможет тебе <b>автоматизировать</b> процесс в редактировании Word документов.\n\n"
        "Отправьте мне Word-файл и я выделю имена иноагентов <b>красным цветом</b>.",
        parse_mode='HTML'
    )

def handle_doc(update: Update, context=None):
    file = update.message.document.get_file()
    file_bytes = BytesIO()
    file.download(out=file_bytes)
    file_bytes.seek(0)

    doc = Document(file_bytes)

    for para in doc.paragraphs:
        original_text = para.text
        para.clear()  # Очищаем параграф, чтобы вручную вставить отформатированные куски

        i = 0
        while i < len(original_text):
            match_found = False
            for name in FOREIGN_AGENT_NAMES:
                if original_text[i:i+len(name)] == name:
                    run = para.add_run(name)
                    run.font.color.rgb = RGBColor(255, 0, 0)  # Красный цвет
                    i += len(name)
                    match_found = True
                    break
            if not match_found:
                run = para.add_run(original_text[i])
                i += 1

    output = BytesIO()
    doc.save(output)
    output.seek(0)

    update.message.reply_document(document=output, filename="Готовый файл.docx")

# Регистрируем обработчики
dispatcher.add_handler(CommandHandler("start", start))
dispatcher.add_handler(MessageHandler(Filters.document.mime_type("application/vnd.openxmlformats-officedocument.wordprocessingml.document"), handle_doc))

@app.route(f"/{TOKEN}", methods=["POST"])
def webhook():
    data = request.get_json(force=True)
    update = Update.de_json(data, bot)
    dispatcher.process_update(update)
    return "ok"

@app.route("/")
def index():
    return "Bot is running"

if __name__ == "__main__":
    port = int(os.environ.get("PORT", 5000))
    print(f"Starting app on port {port}")
    app.run(host="0.0.0.0", port=port)
